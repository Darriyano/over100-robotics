<script lang="ts">
	import '../../styles/map-styles.css';
	import { sendDirectionData } from '../../api';

	let dirs: Array<string> = [];

	const send = async () => {
		try {
			await sendDirectionData(dirs);
			alert('Successfully sent! Data: ' + dirs);
			dirs = [];
		} catch (e) {
			console.log(e);
		}
	};

	const a = (direction: string) => {
		dirs.push(direction);
	};
</script>

<head>
	<title>Map</title>
	<meta name="description" content="The page with the robot control by joistic" />
</head>
<div class="page-container">
	Map
	<div class="map-screen">
		<div class="vremeno">The map is loading...</div>
	</div>
	<div class="console">
		<div class="map-buttons">
			<button on:click={() => a('up')} class="map-direction-button" id="map-direction-button_up">
				<svg
					width="27"
					height="32"
					viewBox="0 0 27 32"
					fill="none"
					xmlns="http://www.w3.org/2000/svg"
				>
					<path
						d="M14.8654 1.47774C14.4879 1.15605 13.976 0.975342 13.4422 0.975342C12.9084 0.975342 12.3964 1.15605 12.0189 1.47774L0.63116 11.1847C0.438894 11.3429 0.285536 11.5323 0.180034 11.7416C0.0745326 11.951 0.0190002 12.1762 0.0166776 12.404C0.0143549 12.6318 0.0652888 12.8578 0.166506 13.0687C0.267724 13.2795 0.417199 13.4711 0.606209 13.6322C0.795219 13.7933 1.01998 13.9208 1.26737 14.007C1.51477 14.0933 1.77985 14.1367 2.04714 14.1347C2.31443 14.1328 2.57858 14.0854 2.82418 13.9955C3.06978 13.9056 3.29191 13.7748 3.4776 13.611L11.4291 6.8331V29.5569C11.4291 30.012 11.6412 30.4485 12.0187 30.7703C12.3962 31.0921 12.9083 31.2729 13.4422 31.2729C13.9761 31.2729 14.4881 31.0921 14.8656 30.7703C15.2431 30.4485 15.4552 30.012 15.4552 29.5569V6.8331L23.4067 13.611C23.7864 13.9235 24.2949 14.0965 24.8227 14.0926C25.3505 14.0887 25.8554 13.9082 26.2286 13.5901C26.6019 13.2719 26.8136 12.8415 26.8182 12.3916C26.8228 11.9417 26.6199 11.5083 26.2532 11.1847L14.8654 1.47774Z"
						fill="#2D3037"
					/>
				</svg>
			</button>
		</div>
		<div class="map-buttons">
			<button
				on:click={() => a('left')}
				class="map-direction-button"
				id="map-direction_button_left"
			>
				<svg
					width="32"
					height="27"
					viewBox="0 0 32 27"
					fill="none"
					xmlns="http://www.w3.org/2000/svg"
				>
					<path
						d="M1.47749 11.9859C1.15581 12.3634 0.975098 12.8754 0.975098 13.4092C0.975098 13.9429 1.15581 14.4549 1.47749 14.8324L11.1844 26.2202C11.3427 26.4124 11.532 26.5658 11.7414 26.6713C11.9507 26.7768 12.1759 26.8323 12.4037 26.8346C12.6316 26.837 12.8575 26.786 13.0684 26.6848C13.2793 26.5836 13.4709 26.4341 13.632 26.2451C13.7931 26.0561 13.9205 25.8313 14.0068 25.5839C14.0931 25.3365 14.1365 25.0715 14.1345 24.8042C14.1325 24.5369 14.0852 24.2727 13.9953 24.0271C13.9053 23.7815 13.7746 23.5594 13.6107 23.3737L6.83286 15.4222L29.5567 15.4222C30.0118 15.4222 30.4482 15.2101 30.77 14.8326C31.0918 14.4551 31.2726 13.943 31.2726 13.4092C31.2726 12.8753 31.0918 12.3632 30.77 11.9857C30.4482 11.6082 30.0118 11.3961 29.5567 11.3961L6.83286 11.3961L13.6107 3.44459C13.9233 3.06492 14.0962 2.55643 14.0923 2.02861C14.0884 1.5008 13.908 0.995905 13.5898 0.622669C13.2717 0.249435 12.8413 0.0377235 12.3914 0.0331383C11.9415 0.0285511 11.508 0.231455 11.1844 0.598146L1.47749 11.9859Z"
						fill="#2D3037"
					/>
				</svg>
			</button>
			<button
				on:click={() => a('down')}
				class="map-direction-button"
				id="map-direction_button_down"
			>
				<svg
					width="27"
					height="32"
					viewBox="0 0 27 32"
					fill="none"
					xmlns="http://www.w3.org/2000/svg"
				>
					<path
						d="M11.9691 30.6631C12.3466 30.9848 12.8585 31.1655 13.3923 31.1655C13.9261 31.1655 14.438 30.9848 14.8155 30.6631L26.2033 20.9562C26.3956 20.7979 26.5489 20.6086 26.6544 20.3992C26.7599 20.1899 26.8155 19.9647 26.8178 19.7369C26.8201 19.509 26.7692 19.2831 26.668 19.0722C26.5667 18.8613 26.4173 18.6697 26.2283 18.5086C26.0393 18.3475 25.8145 18.2201 25.5671 18.1338C25.3197 18.0476 25.0546 18.0041 24.7873 18.0061C24.52 18.0081 24.2559 18.0554 24.0103 18.1454C23.7647 18.2353 23.5426 18.366 23.3569 18.5299L15.4054 25.3078L15.4054 2.58392C15.4054 2.12883 15.1933 1.69238 14.8157 1.37058C14.4382 1.04879 13.9262 0.868008 13.3923 0.868008C12.8584 0.868008 12.3464 1.04879 11.9689 1.37058C11.5914 1.69238 11.3793 2.12883 11.3793 2.58392L11.3793 25.3078L3.42774 18.5299C3.04808 18.2173 2.53958 18.0444 2.01177 18.0483C1.48396 18.0522 0.979059 18.2327 0.605824 18.5508C0.23259 18.869 0.0208778 19.2993 0.0162926 19.7492C0.0117054 20.1991 0.214609 20.6326 0.581301 20.9562L11.9691 30.6631Z"
						fill="#2D3037"
					/>
				</svg>
			</button>
			<button
				on:click={() => a('right')}
				class="map-direction-button"
				id="map-direction_button_right"
			>
				<svg
					width="31"
					height="28"
					viewBox="0 0 31 28"
					fill="none"
					xmlns="http://www.w3.org/2000/svg"
				>
					<path
						d="M29.9395 15.4648C30.2612 15.0872 30.4419 14.5753 30.4419 14.0415C30.4419 13.5077 30.2612 12.9958 29.9395 12.6183L20.2326 1.23053C20.0743 1.03826 19.8849 0.884901 19.6756 0.779399C19.4662 0.673898 19.2411 0.618365 19.0132 0.616043C18.7854 0.61372 18.5595 0.664654 18.3486 0.765872C18.1377 0.867089 17.9461 1.01656 17.785 1.20557C17.6239 1.39458 17.4965 1.61934 17.4102 1.86674C17.3239 2.11413 17.2805 2.37921 17.2825 2.6465C17.2845 2.91379 17.3318 3.17794 17.4217 3.42354C17.5117 3.66914 17.6424 3.89127 17.8063 4.07697L24.5841 12.0285L1.86029 12.0285C1.4052 12.0285 0.968748 12.2406 0.646952 12.6181C0.325157 12.9956 0.144375 13.5076 0.144375 14.0415C0.144375 14.5754 0.325157 15.0874 0.646952 15.465C0.968748 15.8425 1.4052 16.0546 1.86029 16.0546H24.5841L17.8063 24.0061C17.4937 24.3858 17.3208 24.8943 17.3247 25.4221C17.3286 25.9499 17.509 26.4548 17.8272 26.828C18.1453 27.2012 18.5757 27.413 19.0256 27.4175C19.4755 27.4221 19.9089 27.2192 20.2326 26.8525L29.9395 15.4648Z"
						fill="#2D3037"
					/>
				</svg>
			</button>
		</div>
		<button class="send-btn" on:click={send}>Send data</button>
	</div>
</div>
